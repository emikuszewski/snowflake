<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PlainID Snowflake Policy Orchestration - Technical Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0066cc;
            --code-bg: #1e293b;
            --border: #e2e8f0;
            --text: #334155;
            --sidebar-bg: #f8fafc;
            --accent: #059669;
            --warning: #dc2626;
            --info: #0284c7;
            --main-bg: #ffffff;
            --box-bg: #ffffff;
            --pop-color: #8b5cf6;
            --flow-bg-start: #f8fafc;
            --flow-bg-end: #e2e8f0;
        }

        body {
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            line-height: 1.6;
            color: var(--text);
            display: flex;
            height: 100vh;
            overflow: hidden;
            background: var(--main-bg);
        }

        /* Watermark */
        .watermark {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            text-align: center;
            padding: 4px 0;
            background: rgba(248, 250, 252, 0.95);
            border-bottom: 1px solid rgba(226, 232, 240, 0.5);
            z-index: 9999;
            font-size: 11px;
            color: rgba(100, 116, 139, 0.7);
            font-style: italic;
        }

        .watermark a {
            color: inherit;
            text-decoration: none;
            transition: color 0.2s;
        }

        .watermark a:hover {
            color: var(--primary);
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border);
            overflow-y: auto;
            padding: 2rem 1rem;
            margin-top: 28px; /* Account for watermark */
        }

        .sidebar h3 {
            font-size: 0.875rem;
            text-transform: uppercase;
            color: #94a3b8;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        .sidebar ul {
            list-style: none;
            margin-bottom: 1.5rem;
        }

        .sidebar li {
            margin: 0.25rem 0;
        }

        .sidebar a {
            color: var(--text);
            text-decoration: none;
            font-size: 0.875rem;
            padding: 0.25rem 0.5rem;
            display: block;
            border-radius: 4px;
            transition: background 0.2s;
        }

        .sidebar a:hover,
        .sidebar a.active {
            background: white;
            color: var(--primary);
        }

        /* Main Content */
        .main {
            flex: 1;
            overflow-y: auto;
            padding: 2rem 3rem;
            max-width: 1000px;
            margin-top: 28px; /* Account for watermark */
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 2rem;
            margin-bottom: 1rem;
            padding-top: 1rem;
            border-top: 1px solid var(--border);
        }

        h3 {
            font-size: 1.125rem;
            margin-top: 1.5rem;
            margin-bottom: 0.75rem;
            color: var(--primary);
        }

        p {
            margin-bottom: 1rem;
            line-height: 1.7;
        }

        /* Code Block - Updated for better formatting */
        .code {
            background: var(--code-bg);
            color: #e2e8f0;
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
            overflow-x: auto;
        }

        .code pre {
            margin: 0;
            font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
            font-size: 0.875rem;
            line-height: 1.5;
            white-space: pre;
            color: #e2e8f0;
        }

        .code-inline {
            background: #f1f5f9;
            padding: 0.125rem 0.25rem;
            border-radius: 3px;
            font-family: 'SF Mono', Monaco, monospace;
            font-size: 0.875rem;
            color: var(--primary);
        }

        /* Table */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
            font-size: 0.875rem;
        }

        th, td {
            text-align: left;
            padding: 0.75rem;
            border: 1px solid var(--border);
        }

        th {
            background: var(--sidebar-bg);
            font-weight: 600;
        }

        tbody tr {
            background: var(--box-bg);
        }

        tbody tr:hover {
            background: var(--sidebar-bg);
        }

        /* Alert */
        .alert {
            padding: 1rem;
            border-radius: 6px;
            margin: 1rem 0;
            border-left: 4px solid;
        }

        .alert.info {
            background: #eff6ff;
            border-color: var(--info);
        }

        .alert.warning {
            background: #fef2f2;
            border-color: var(--warning);
        }

        .alert.success {
            background: #f0fdf4;
            border-color: var(--accent);
        }

        .alert.pop {
            background: #faf5ff;
            border-color: var(--pop-color);
        }

        /* Architecture Diagram */
        .architecture {
            background: var(--box-bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 2rem;
            margin: 1.5rem 0;
            text-align: center;
        }

        .flow {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin: 2rem 0;
            gap: 1rem;
        }

        .component {
            background: var(--sidebar-bg);
            border: 2px solid var(--border);
            padding: 1rem;
            border-radius: 6px;
            flex: 1;
            font-size: 0.875rem;
        }

        .component.primary {
            border-color: var(--primary);
            background: var(--box-bg);
        }

        .component.pop {
            border-color: var(--pop-color);
            background: #faf5ff;
        }

        .arrow {
            color: var(--primary);
            font-size: 1.5rem;
        }

        /* POP Flow Diagram */
        .pop-flow {
            background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
        }

        .pop-stages {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .pop-stage {
            background: white;
            border: 2px solid var(--pop-color);
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
            position: relative;
            transition: all 0.3s;
        }

        .pop-stage:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(139, 92, 246, 0.2);
        }

        .pop-stage-number {
            background: var(--pop-color);
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
        }

        .pop-stage-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--pop-color);
        }

        .pop-stage-desc {
            font-size: 0.875rem;
            color: var(--text);
        }

        /* Mode Toggle */
        .mode-toggle {
            display: inline-flex;
            background: var(--sidebar-bg);
            border-radius: 6px;
            padding: 4px;
            margin: 1rem 0;
        }

        .mode-toggle button {
            padding: 0.5rem 1rem;
            border: none;
            background: transparent;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s;
        }

        .mode-toggle button.active {
            background: white;
            color: var(--pop-color);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Visual Flow Diagrams */
        .flow-visual {
            background: linear-gradient(135deg, var(--flow-bg-start) 0%, var(--flow-bg-end) 100%);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
        }

        .flow-container {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2rem;
            position: relative;
            z-index: 2;
        }

        .flow-node {
            background: var(--box-bg);
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 1.5rem 1rem;
            text-align: center;
            position: relative;
            transition: all 0.3s;
            cursor: pointer;
        }

        .flow-node:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.1);
            border-color: var(--primary);
        }

        .flow-node.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(0, 102, 204, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(0, 102, 204, 0); }
            100% { box-shadow: 0 0 0 0 rgba(0, 102, 204, 0); }
        }

        .flow-node-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .flow-node-title {
            font-weight: 600;
            margin-bottom: 0.25rem;
            font-size: 0.9rem;
        }

        .flow-node-desc {
            font-size: 0.75rem;
            color: #64748b;
            line-height: 1.3;
        }

        .flow-node.active .flow-node-desc {
            color: rgba(255,255,255,0.9);
        }

        /* Connection Lines */
        .flow-connections {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }

        .flow-line {
            stroke: var(--primary);
            stroke-width: 2;
            fill: none;
            stroke-dasharray: 5, 5;
            animation: dash 20s linear infinite;
        }

        @keyframes dash {
            to { stroke-dashoffset: -100; }
        }

        .flow-line.active {
            stroke-width: 3;
            stroke: var(--accent);
            stroke-dasharray: none;
        }

        /* Sequence Diagram */
        .sequence-diagram {
            background: var(--box-bg);
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 2rem;
            margin: 2rem 0;
            overflow-x: auto;
        }

        .sequence-actors {
            display: flex;
            justify-content: space-between;
            margin-bottom: 3rem;
            position: relative;
        }

        .actor {
            background: var(--primary);
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            font-weight: 600;
            text-align: center;
            min-width: 120px;
            position: relative;
        }

        .actor::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            width: 2px;
            height: 400px;
            background: var(--border);
            transform: translateX(-50%);
        }

        .sequence-messages {
            position: relative;
            height: 400px;
        }

        .message {
            position: absolute;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem;
            background: #f8fafc;
            border-radius: 4px;
            font-size: 0.875rem;
            white-space: nowrap;
            transition: all 0.3s;
        }

        .message:hover {
            background: #eff6ff;
            transform: scale(1.05);
        }

        .message-arrow {
            width: 100px;
            height: 2px;
            background: var(--primary);
            position: relative;
        }

        .message-arrow::after {
            content: '‚ñ∂';
            position: absolute;
            right: -10px;
            top: -8px;
            color: var(--primary);
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 2px solid var(--border);
            margin: 1rem 0;
        }

        .tab {
            padding: 0.5rem 1rem;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 0.875rem;
            color: var(--text);
            transition: all 0.2s;
        }

        .tab.active {
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
            margin-bottom: -2px;
        }

        .tab-content {
            display: none;
            padding: 1rem 0;
        }

        .tab-content.active {
            display: block;
        }

        /* List */
        ul {
            margin: 1rem 0;
            padding-left: 1.5rem;
        }

        li {
            margin: 0.5rem 0;
        }

        /* Endpoint */
        .endpoint {
            background: var(--sidebar-bg);
            border: 1px solid var(--border);
            border-radius: 6px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .method {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 0.5rem;
        }

        .method.post { background: #10b981; color: white; }
        .method.get { background: #3b82f6; color: white; }
        .method.put { background: #f59e0b; color: white; }
        .method.delete { background: #ef4444; color: white; }
    </style>
</head>
<body>
    <!-- Watermark -->
    <div class="watermark">
        <a href="https://docs.plainid.io" target="_blank" rel="noopener noreferrer">
            Made by the SE Team For Walkthrough Purposes Only
        </a>
    </div>

    <!-- Sidebar Navigation -->
    <nav class="sidebar">
        <h3>Policy Orchestration</h3>
        <ul>
            <li><a href="#overview" class="active">System Overview</a></li>
            <li><a href="#pop-architecture">POP Architecture</a></li>
            <li><a href="#snowflake-pop">Snowflake POP</a></li>
            <li><a href="#modes">Learn & Manage Modes</a></li>
        </ul>

        <h3>Configuration</h3>
        <ul>
            <li><a href="#pop-setup">POP Setup</a></li>
            <li><a href="#discovery">Discovery Process</a></li>
            <li><a href="#policy-mapping">Policy Mapping</a></li>
            <li><a href="#orchestration-workspace">Orchestration Workspace</a></li>
        </ul>

        <h3>Authorization Patterns</h3>
        <ul>
            <li><a href="#policy-resolution">Policy Resolution</a></li>
            <li><a href="#data-masking">Data Masking</a></li>
            <li><a href="#row-filtering">Row-Level Filtering</a></li>
            <li><a href="#column-access">Column Access Control</a></li>
        </ul>

        <h3>Deployment</h3>
        <ul>
            <li><a href="#monitoring">Monitoring & Auditing</a></li>
            <li><a href="#troubleshooting">Troubleshooting</a></li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main">
        <h1>PlainID Snowflake Policy Orchestration</h1>
        <p>Technical documentation for implementing Policy Orchestration Points (POPs) for Snowflake Data Cloud environments using PlainID's SaaS Authorization Management.</p>

        <div class="alert pop">
            <strong>Architecture Pattern:</strong> Snowflake integration uses PlainID's Policy Orchestration Point (POP) pattern for SaaS Authorization Management, enabling centralized policy discovery, management, and enforcement.
        </div>
        
        <div class="alert info">
            <strong>Version:</strong> PlainID Platform 2024.1+ | <strong>Feature:</strong> Snowflake Policy Orchestration Point | <strong>Announced:</strong> December 2024<br>
            <strong>Snowflake Requirements:</strong> Enterprise Edition or higher (required for Row Access Policies and Dynamic Data Masking)
        </div>

        <!-- System Overview -->
        <section id="overview">
            <h2>System Overview</h2>
            <p>PlainID's Snowflake integration leverages Policy Orchestration to centralize Snowflake's access controls through a unified Policy-Based Access Control (PBAC) framework. The Policy Orchestration Point (POP) enables enterprises to discover, manage, and enforce data access policies across their Snowflake environments.</p>

            <!-- Core Components Architecture -->
            <div class="architecture" style="background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%); padding: 3rem;">
                <h3 style="margin-bottom: 2rem;">Core Components Architecture</h3>
                
                <!-- Main Architecture Flow -->
                <svg viewBox="0 0 1000 480" style="width: 100%; height: auto;">
                    <defs>
                        <marker id="arrowhead-purple" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto" markerUnits="strokeWidth">
                            <polygon points="0 0, 10 3, 0 6" fill="#8b5cf6"/>
                        </marker>
                        <marker id="arrowhead-blue" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto" markerUnits="strokeWidth">
                            <polygon points="0 0, 10 3, 0 6" fill="#0284c7"/>
                        </marker>
                        <filter id="shadow" x="-50%" y="-50%" width="200%" height="200%">
                            <feDropShadow dx="2" dy="2" stdDeviation="3" flood-opacity="0.2"/>
                        </filter>
                    </defs>
                    
                    <!-- PlainID Cloud Section -->
                    <g id="plainid-cloud">
                        <rect x="50" y="50" width="400" height="200" rx="12" fill="#8b5cf6" opacity="0.1" stroke="#8b5cf6" stroke-width="2"/>
                        <text x="250" y="80" fill="#8b5cf6" text-anchor="middle" font-size="18" font-weight="bold">PlainID Cloud Platform</text>
                        
                        <!-- PAP Box -->
                        <rect x="80" y="110" width="140" height="80" rx="6" fill="#ffffff" stroke="#8b5cf6" stroke-width="2" filter="url(#shadow)"/>
                        <text x="150" y="140" text-anchor="middle" font-size="14" font-weight="bold">PAP</text>
                        <text x="150" y="160" text-anchor="middle" font-size="11" fill="#64748b">Policy Admin Point</text>
                        <text x="150" y="175" text-anchor="middle" font-size="10" fill="#64748b">Policy Creation</text>
                        
                        <!-- POP Service Box -->
                        <rect x="260" y="110" width="160" height="80" rx="6" fill="#faf5ff" stroke="#8b5cf6" stroke-width="3" filter="url(#shadow)"/>
                        <text x="340" y="140" text-anchor="middle" font-size="14" font-weight="bold">POP Service</text>
                        <text x="340" y="160" text-anchor="middle" font-size="11" fill="#64748b">Orchestration Engine</text>
                        <text x="340" y="175" text-anchor="middle" font-size="10" fill="#64748b">Discovery & Deploy</text>
                    </g>
                    
                    <!-- Snowflake Environment -->
                    <g id="snowflake-env">
                        <rect x="550" y="50" width="400" height="350" rx="12" fill="#0284c7" opacity="0.05" stroke="#0284c7" stroke-width="2"/>
                        <text x="750" y="80" fill="#0284c7" text-anchor="middle" font-size="18" font-weight="bold">Snowflake Environment</text>
                        
                        <!-- Native Policies -->
                        <rect x="600" y="110" width="300" height="80" rx="6" fill="#ffffff" stroke="#0284c7" stroke-width="2" filter="url(#shadow)"/>
                        <text x="750" y="140" text-anchor="middle" font-size="14" font-weight="bold">Native Snowflake Policies</text>
                        <text x="750" y="160" text-anchor="middle" font-size="11" fill="#64748b">Row Access Policies</text>
                        <text x="750" y="175" text-anchor="middle" font-size="10" fill="#64748b">Masking Policies</text>
                        
                        <!-- Snowflake Objects -->
                        <rect x="600" y="220" width="140" height="70" rx="6" fill="#ffffff" stroke="#0284c7" stroke-width="2" filter="url(#shadow)"/>
                        <text x="670" y="250" text-anchor="middle" font-size="13" font-weight="bold">Databases</text>
                        <text x="670" y="270" text-anchor="middle" font-size="10" fill="#64748b">Schemas, Tables</text>
                        
                        <rect x="760" y="220" width="140" height="70" rx="6" fill="#ffffff" stroke="#0284c7" stroke-width="2" filter="url(#shadow)"/>
                        <text x="830" y="250" text-anchor="middle" font-size="13" font-weight="bold">Security Objects</text>
                        <text x="830" y="270" text-anchor="middle" font-size="10" fill="#64748b">Roles, Users</text>
                        
                        <!-- Virtual Warehouses -->
                        <rect x="600" y="310" width="300" height="70" rx="6" fill="#e0f2fe" stroke="#0284c7" stroke-width="2" filter="url(#shadow)"/>
                        <text x="750" y="340" text-anchor="middle" font-size="13" font-weight="bold">Virtual Warehouses</text>
                        <text x="750" y="360" text-anchor="middle" font-size="10" fill="#64748b">Compute clusters that enforce policies at runtime</text>
                    </g>
                    
                    <!-- Connection Lines -->
                    <g id="connections">
                        <!-- PAP to POP -->
                        <line x1="220" y1="150" x2="260" y2="150" stroke="#8b5cf6" stroke-width="2" marker-end="url(#arrowhead-purple)"/>
                        
                        <!-- POP to Snowflake (Bidirectional) -->
                        <line x1="420" y1="150" x2="600" y2="150" stroke="#8b5cf6" stroke-width="3" marker-end="url(#arrowhead-purple)"/>
                        <line x1="600" y1="160" x2="420" y2="160" stroke="#0284c7" stroke-width="2" marker-end="url(#arrowhead-blue)"/>
                        <text x="510" y="145" fill="#8b5cf6" font-size="11" text-anchor="middle">Deploy Policies</text>
                        <text x="510" y="175" fill="#0284c7" font-size="11" text-anchor="middle">Discover Objects</text>
                        
                        <!-- Snowflake Internal -->
                        <line x1="750" y1="190" x2="750" y2="310" stroke="#0284c7" stroke-width="2" stroke-dasharray="3,3" marker-end="url(#arrowhead-blue)"/>
                        
                        <!-- End User to Virtual Warehouses -->
                        <line x1="750" y1="415" x2="750" y2="380" stroke="#334155" stroke-width="2" marker-end="url(#arrowhead-blue)"/>
                    </g>
                    
                    <!-- User Icon -->
                    <circle cx="750" cy="435" r="20" fill="#ffffff" stroke="#334155" stroke-width="2" filter="url(#shadow)"/>
                    <text x="750" y="440" text-anchor="middle" font-size="16">üë§</text>
                    <text x="750" y="470" fill="#334155" text-anchor="middle" font-size="11">End User</text>
                </svg>
            </div>

            <!-- End-to-End Authorization Flow -->
            <div class="flow-visual">
                <h3 style="margin-bottom: 2rem;">End-to-End Authorization Flow</h3>
                <div class="flow-container">
                    <div class="flow-node" onclick="highlightStep(1)">
                        <div class="flow-node-icon">üë§</div>
                        <div class="flow-node-title">User Query</div>
                        <div class="flow-node-desc">User executes SELECT on Snowflake table</div>
                    </div>
                    <div class="flow-node" onclick="highlightStep(2)">
                        <div class="flow-node-icon">‚ùÑÔ∏è</div>
                        <div class="flow-node-title">Snowflake</div>
                        <div class="flow-node-desc">Triggers external authorization function</div>
                    </div>
                    <div class="flow-node" onclick="highlightStep(3)">
                        <div class="flow-node-icon">üîê</div>
                        <div class="flow-node-title">PlainID POP</div>
                        <div class="flow-node-desc">Evaluates policies & resolves attributes</div>
                    </div>
                    <div class="flow-node" onclick="highlightStep(4)">
                        <div class="flow-node-icon">‚úÖ</div>
                        <div class="flow-node-title">Decision</div>
                        <div class="flow-node-desc">Returns filtered/masked result set</div>
                    </div>
                </div>
                <div style="width: 100%; height: 50px; margin-top: 15px; position: relative;">
                    <svg viewBox="0 0 800 50" style="width: 100%; height: 100%;">
                        <defs>
                            <marker id="arrowhead-flow" markerWidth="10" markerHeight="10" refX="8" refY="3" orient="auto">
                                <polygon points="0 0, 10 3, 0 6" fill="#0066cc"/>
                            </marker>
                        </defs>
                        <path class="flow-line" d="M 100 5 Q 200 35, 300 5" marker-end="url(#arrowhead-flow)"/>
                        <path class="flow-line" d="M 300 5 Q 400 35, 500 5" marker-end="url(#arrowhead-flow)"/>
                        <path class="flow-line" d="M 500 5 Q 600 35, 700 5" marker-end="url(#arrowhead-flow)"/>
                    </svg>
                </div>
            </div>

            <h3>Key Capabilities</h3>
            <ul>
                <li><strong>Policy Discovery:</strong> Automatic discovery of existing Snowflake row access policies, masking policies, tag-based policies, and role structures</li>
                <li><strong>Centralized Management:</strong> Single pane of glass for managing data access across multiple Snowflake accounts and warehouses</li>
                <li><strong>Bi-directional Sync:</strong> Policies created in PlainID are deployed and enforced in Snowflake</li>
                <li><strong>Visual Policy Mapping:</strong> Graphical representation of complex access policies</li>
                <li><strong>Audit & Compliance:</strong> Complete visibility and audit trail of all policy changes</li>
                <li><strong>Tag-Based Governance:</strong> Support for Snowflake's tag-based security policies for metadata-driven access control</li>
            </ul>
        </section>

        <!-- POP Architecture -->
        <section id="pop-architecture">
            <h2>Policy Orchestration Point (POP) Architecture</h2>
            
            <div class="architecture">
                <h3>SaaS Authorization Management Pattern</h3>
                <div class="flow">
                    <div class="component pop">
                        <strong>PlainID Cloud</strong><br>
                        Policy Administration<br>
                        <small>PAP + Policy Store</small>
                    </div>
                    <span class="arrow">‚Üî</span>
                    <div class="component pop">
                        <strong>Snowflake POP</strong><br>
                        Orchestration Layer<br>
                        <small>Discover & Deploy</small>
                    </div>
                    <span class="arrow">‚Üî</span>
                    <div class="component">
                        <strong>Snowflake</strong><br>
                        Native Policies<br>
                        <small>Row Access & Masking</small>
                    </div>
                </div>
            </div>

            <h3>POP Components</h3>
            <table>
                <tr>
                    <th>Component</th>
                    <th>Function</th>
                    <th>Location</th>
                </tr>
                <tr>
                    <td>Policy Orchestration Service</td>
                    <td>Manages bi-directional sync between PlainID and Snowflake</td>
                    <td>PlainID Cloud</td>
                </tr>
                <tr>
                    <td>Discovery Engine</td>
                    <td>Scans and maps Snowflake objects and policies</td>
                    <td>POP Service</td>
                </tr>
                <tr>
                    <td>Policy Translator</td>
                    <td>Converts between PlainID policies and Snowflake native policies</td>
                    <td>POP Service</td>
                </tr>
                <tr>
                    <td>Deployment Engine</td>
                    <td>Applies policy changes to Snowflake environments</td>
                    <td>POP Service</td>
                </tr>
            </table>

            <div class="alert warning">
                <strong>Important:</strong> Unlike Data Authorizers that use PAA/PDP/PIP components, POPs operate as a SaaS service that orchestrates native vendor policies. For Snowflake, this means managing Snowflake's native row access policies and masking policies.
            </div>
        </section>

        <!-- Snowflake POP -->
        <section id="snowflake-pop">
            <h2>Snowflake Policy Orchestration Point</h2>
            
            <h3>Integration Overview</h3>
            <p>The Snowflake POP enables PlainID to discover, manage, and deploy authorization policies using Snowflake's native security features.</p>

            <h3>Discovered Objects</h3>
            <div class="code">
<pre># Objects automatically discovered during POP initialization:

DATABASES
‚îú‚îÄ‚îÄ Schemas
‚îú‚îÄ‚îÄ Tables
‚îÇ   ‚îú‚îÄ‚îÄ Columns (with data types)
‚îÇ   ‚îî‚îÄ‚îÄ Row Access Policies
‚îú‚îÄ‚îÄ Views
‚îÇ   ‚îú‚îÄ‚îÄ Columns
‚îÇ   ‚îî‚îÄ‚îÄ Access Policies
‚îú‚îÄ‚îÄ External Functions
‚îî‚îÄ‚îÄ Warehouses

SECURITY OBJECTS
‚îú‚îÄ‚îÄ Roles (System & Custom)
‚îú‚îÄ‚îÄ Users
‚îú‚îÄ‚îÄ Masking Policies
‚îÇ   ‚îú‚îÄ‚îÄ Standard Masking Policies
‚îÇ   ‚îî‚îÄ‚îÄ Tag-Based Masking Policies
‚îú‚îÄ‚îÄ Row Access Policies
‚îú‚îÄ‚îÄ Network Policies
‚îî‚îÄ‚îÄ Tags (for Tag-Based Security)

METADATA
‚îú‚îÄ‚îÄ Tags
‚îú‚îÄ‚îÄ Classifications
‚îú‚îÄ‚îÄ Policy Associations
‚îî‚îÄ‚îÄ Data Lineage</pre>
            </div>

            <h3>Policy Translation</h3>
            <p>PlainID policies are automatically translated to Snowflake native constructs:</p>
            
            <table>
                <tr>
                    <th>PlainID Policy Type</th>
                    <th>Snowflake Implementation</th>
                    <th>Example</th>
                </tr>
                <tr>
                    <td>Row-Level Security</td>
                    <td>ROW ACCESS POLICY</td>
                    <td><span class="code-inline">region = current_user_region()</span></td>
                </tr>
                <tr>
                    <td>Column Masking</td>
                    <td>MASKING POLICY</td>
                    <td><span class="code-inline">CASE WHEN role IN ('ANALYST') THEN val ELSE '***' END</span></td>
                </tr>
                <tr>
                    <td>Dynamic Groups</td>
                    <td>Role Hierarchies + Policies</td>
                    <td>Mapped to Snowflake role structures with IS_ROLE_IN_SESSION()</td>
                </tr>
                <tr>
                    <td>Attribute-Based Access</td>
                    <td>Context Functions + Policies</td>
                    <td><span class="code-inline">current_role(), current_user(), current_account()</span></td>
                </tr>
                <tr>
                    <td>Tag-Based Policies</td>
                    <td>TAG + MASKING/ROW ACCESS POLICY</td>
                    <td><span class="code-inline">SYSTEM$GET_TAG_ON_CURRENT_COLUMN('tag_name')</span></td>
                </tr>
            </table>

            <h3>Tag-Based Security Policies</h3>
            <p>PlainID POP also discovers and manages Snowflake's tag-based security policies, enabling centralized governance through metadata tagging:</p>
            
            <div class="code">
<pre># Example: Tag-Based Masking Policy Discovery
-- Snowflake Tag-Based Policy
CREATE TAG pii_classification;
CREATE MASKING POLICY tag_based_pii_mask AS (val STRING)
RETURNS STRING ->
  CASE 
    WHEN SYSTEM$GET_TAG_ON_CURRENT_COLUMN('pii_classification') = 'SENSITIVE'
      AND CURRENT_ROLE() NOT IN ('DATA_STEWARD')
    THEN '***MASKED***'
    ELSE val
  END;

-- Apply tag to columns
ALTER TABLE customer_data MODIFY COLUMN ssn SET TAG pii_classification = 'SENSITIVE';
ALTER TAG pii_classification SET MASKING POLICY tag_based_pii_mask;</pre>
            </div>

            <h3>Policy Evaluation Order</h3>
            <div class="alert info">
                <strong>Important:</strong> When both row access policies and masking policies are applied to the same table:
                <ol>
                    <li><strong>Row Access Policies are evaluated first</strong> - Filters which rows the user can see</li>
                    <li><strong>Masking Policies are evaluated second</strong> - Masks sensitive data in the returned rows</li>
                    <li>If a column has both a direct masking policy and a tag-based masking policy, the direct policy takes precedence</li>
                </ol>
            </div>
        </section>

        <!-- Learn & Manage Modes -->
        <section id="modes">
            <h2>Learn & Manage Modes</h2>
            
            <div class="mode-toggle">
                <button class="active" onclick="showMode('learn')">Learn Mode</button>
                <button onclick="showMode('manage')">Manage Mode</button>
            </div>

            <div id="learn-mode" class="mode-content">
                <h3>Learn Mode (Discovery)</h3>
                <p>Initial integration phase where PlainID discovers and maps existing Snowflake policies without making changes.</p>
                
                <div class="alert info">
                    <strong>Purpose:</strong> Provides full visibility into existing policies and access patterns before enabling management capabilities.
                </div>

                <h4>Learn Mode Activities:</h4>
                <ul>
                    <li>Discovers all Snowflake databases, schemas, tables, and views</li>
                    <li>Maps existing row access policies and masking policies</li>
                    <li>Identifies role hierarchies and user assignments</li>
                    <li>Translates Snowflake policies to PlainID policy representation</li>
                    <li>Generates Policy Map visualization</li>
                    <li>Creates audit reports of current access patterns</li>
                </ul>

                <div class="code">
<pre>// Example: Discovered Snowflake Policy
CREATE ROW ACCESS POLICY sales_region_policy
AS (region_column VARCHAR) 
RETURNS BOOLEAN ->
  EXISTS (
    SELECT 1 FROM sales_managers 
    WHERE manager_id = CURRENT_USER() 
    AND region = region_column
  );

// Applied to table using:
ALTER TABLE sales_data 
SET ROW ACCESS POLICY sales_region_policy ON (region);

// Translated to PlainID Policy Structure
{
  "policyName": "sales_region_policy",
  "type": "row_filter",
  "condition": {
    "type": "exists",
    "source": "sales_managers",
    "match": {
      "manager_id": "${user.id}",
      "region": "${row.region_column}"
    }
  }
}</pre>
                </div>
            </div>

            <div id="manage-mode" class="mode-content" style="display: none;">
                <h3>Manage Mode (Active Orchestration)</h3>
                <p>Full policy management where PlainID becomes the authoritative source for Snowflake policies.</p>
                
                <div class="alert success">
                    <strong>Capability:</strong> Create, update, and delete policies in PlainID that are automatically deployed to Snowflake.
                </div>

                <div class="alert warning">
                    <strong>Note:</strong> To modify an existing Snowflake policy, it must first be discovered in Learn Mode. PlainID can then manage it in Manage Mode. For policies with the same name, Snowflake requires dropping the old policy before creating a new one with different signatures.
                </div>

                <h4>Manage Mode Features:</h4>
                <ul>
                    <li>Create new policies in PlainID's visual interface</li>
                    <li>Deploy policies to Snowflake automatically</li>
                    <li>Update existing Snowflake policies through PlainID</li>
                    <li>Synchronize policy changes across environments</li>
                    <li>Enforce approval workflows before deployment</li>
                    <li>Rollback policy changes if needed</li>
                </ul>

                <h4>Policy Deployment Example:</h4>
                <div class="code">
<pre># PlainID Policy (Visual Editor)
Policy: "PII Data Protection"
Target: CUSTOMER_DATA.PERSONAL_INFO
Rules:
  - If user.department != 'HR' 
    Then mask(ssn, credit_card)
  - If user.clearance_level < 3
    Then deny_access()

# Auto-deployed to Snowflake as:
CREATE OR REPLACE MASKING POLICY pii_protection_mask
AS (val STRING) 
RETURNS STRING ->
  CASE 
    WHEN CURRENT_ROLE() IN (SELECT role FROM hr_roles) 
    THEN val
    ELSE '***-**-****'
  END;

ALTER TABLE customer_data.personal_info 
MODIFY COLUMN ssn SET MASKING POLICY pii_protection_mask;

# To remove a policy (if needed):
ALTER TABLE customer_data.personal_info 
MODIFY COLUMN ssn UNSET MASKING POLICY;</pre>
                </div>
            </div>
        </section>

        <!-- POP Setup -->
        <section id="pop-setup">
            <h2>Snowflake POP Setup</h2>
            
            <h3>Prerequisites</h3>
            <ul>
                <li>Snowflake Account with ACCOUNTADMIN or SECURITYADMIN privileges</li>
                <li>Snowflake Enterprise Edition or higher (required for Row Access Policies and Dynamic Data Masking)</li>
                <li>Service Account for PlainID integration</li>
                <li>PlainID Platform access with Orchestration Workspace enabled</li>
                <li>Active Snowflake warehouse for discovery operations</li>
            </ul>

            <h3>Step 1: Create Snowflake Service Account</h3>
            <div class="code">
<pre>-- Create PlainID integration role
CREATE ROLE PLAINID_ORCHESTRATOR;

-- Grant necessary privileges
GRANT USAGE ON WAREHOUSE COMPUTE_WH TO ROLE PLAINID_ORCHESTRATOR;
GRANT USAGE ON ALL DATABASES IN ACCOUNT TO ROLE PLAINID_ORCHESTRATOR;
GRANT USAGE ON ALL SCHEMAS IN DATABASE TO ROLE PLAINID_ORCHESTRATOR;
GRANT SELECT ON ALL TABLES IN SCHEMA TO ROLE PLAINID_ORCHESTRATOR;
GRANT SELECT ON ALL VIEWS IN SCHEMA TO ROLE PLAINID_ORCHESTRATOR;

-- Grant policy management privileges
-- Option 1: Grant on specific schemas
GRANT CREATE ROW ACCESS POLICY ON SCHEMA PUBLIC TO ROLE PLAINID_ORCHESTRATOR;
GRANT CREATE MASKING POLICY ON SCHEMA PUBLIC TO ROLE PLAINID_ORCHESTRATOR;

-- Option 2: Grant on all schemas in database (recommended)
GRANT CREATE ROW ACCESS POLICY ON ALL SCHEMAS IN DATABASE TO ROLE PLAINID_ORCHESTRATOR;
GRANT CREATE MASKING POLICY ON ALL SCHEMAS IN DATABASE TO ROLE PLAINID_ORCHESTRATOR;

-- Grant apply privileges at account level
GRANT APPLY ROW ACCESS POLICY ON ACCOUNT TO ROLE PLAINID_ORCHESTRATOR;
GRANT APPLY MASKING POLICY ON ACCOUNT TO ROLE PLAINID_ORCHESTRATOR;

-- Create service user
CREATE USER PLAINID_SERVICE_USER
  PASSWORD = 'secure_password'
  DEFAULT_ROLE = PLAINID_ORCHESTRATOR;

GRANT ROLE PLAINID_ORCHESTRATOR TO USER PLAINID_SERVICE_USER;</pre>
            </div>

            <h3>Step 2: Configure POP in PlainID</h3>
            <ol>
                <li>Navigate to <strong>Orchestration Workspace</strong></li>
                <li>Click <strong>Add Policy Orchestration Point</strong></li>
                <li>Select <strong>Snowflake</strong> from vendor list</li>
                <li>Configure connection settings:</li>
            </ol>

            <div class="code">
<pre>{
  "displayName": "Snowflake Production POP",
  "connectionSettings": {
    "account": "mycompany.snowflakecomputing.com",
    "warehouse": "COMPUTE_WH",
    "database": "PRODUCTION",
    "authenticationType": "password",
    "username": "PLAINID_SERVICE_USER",
    "password": "${ENCRYPTED_PASSWORD}"
  },
  "discoveryScope": {
    "databases": ["PRODUCTION", "ANALYTICS"],
    "schemas": ["PUBLIC", "SENSITIVE", "REPORTS"],
    "includeMaskingPolicies": true,
    "includeRowAccessPolicies": true,
    "includeRoles": true
  },
  "syncSettings": {
    "mode": "learn",  // Always start with "learn" mode for initial discovery
    "syncInterval": "hourly",
    "conflictResolution": "plainid_wins"  // Options: "plainid_wins", "snowflake_wins", "manual"
  }
}</pre>
            </div>

            <h3>Step 3: Test Connection</h3>
            <div class="alert info">
                Click <strong>Test Connection</strong> to verify PlainID can connect to your Snowflake account and has appropriate permissions. Ensure your warehouse is running before testing.
            </div>
            
            <div class="code">
<pre>-- Verify service account permissions in Snowflake
SHOW GRANTS TO ROLE PLAINID_ORCHESTRATOR;
SHOW GRANTS TO USER PLAINID_SERVICE_USER;

-- Test warehouse access
USE WAREHOUSE COMPUTE_WH;
SELECT CURRENT_WAREHOUSE(), CURRENT_USER(), CURRENT_ROLE();</pre>
            </div>
        </section>

        <!-- Discovery Process -->
        <section id="discovery">
            <h2>Discovery Process</h2>
            
            <h3>Automatic Discovery Flow</h3>
            <p>When a Snowflake POP is created, PlainID automatically initiates a discovery process:</p>

            <div class="alert info">
                <strong>Warehouse Requirement:</strong> Discovery operations require an active Snowflake warehouse. Ensure the warehouse specified in the POP configuration is running and the service account has USAGE privileges on it.
            </div>

            <div class="architecture">
                <div class="flow">
                    <div class="component">
                        <strong>1. Scan</strong><br>
                        Query Snowflake<br>metadata
                    </div>
                    <span class="arrow">‚Üí</span>
                    <div class="component">
                        <strong>2. Map</strong><br>
                        Create PlainID<br>objects
                    </div>
                    <span class="arrow">‚Üí</span>
                    <div class="component">
                        <strong>3. Translate</strong><br>
                        Convert policies to<br>PBAC format
                    </div>
                    <span class="arrow">‚Üí</span>
                    <div class="component">
                        <strong>4. Display</strong><br>
                        Show in Orchestration<br>Workspace
                    </div>
                </div>
            </div>

            <h3>Discovered Elements Mapping</h3>
            <table>
                <tr>
                    <th>Snowflake Object</th>
                    <th>PlainID Mapping</th>
                    <th>Workspace</th>
                </tr>
                <tr>
                    <td>Database.Schema.Table</td>
                    <td>Asset Type</td>
                    <td>Authorization Workspace</td>
                </tr>
                <tr>
                    <td>Columns</td>
                    <td>Asset Attributes</td>
                    <td>Authorization Workspace</td>
                </tr>
                <tr>
                    <td>Roles</td>
                    <td>Dynamic Groups</td>
                    <td>Identity Workspace</td>
                </tr>
                <tr>
                    <td>Users</td>
                    <td>Identities</td>
                    <td>Identity Workspace</td>
                </tr>
                <tr>
                    <td>Row Access Policies</td>
                    <td>Filter Policies</td>
                    <td>Orchestration Workspace</td>
                </tr>
                <tr>
                    <td>Masking Policies</td>
                    <td>Masking Policies</td>
                    <td>Orchestration Workspace</td>
                </tr>
            </table>

            <h3>Manual Discovery Trigger</h3>
            <div class="code">
<pre># Trigger discovery manually from Orchestration Workspace
1. Navigate to Snowflake POP card
2. Click three dots menu (‚ãÆ)
3. Select "Discover Now"
4. Monitor progress in Activity Log

# Discovery API endpoint (for automation)
POST /api/v1/orchestration/pop/{popId}/discover
{
  "scope": "full",  // or "incremental"
  "notify": true
}</pre>
            </div>
        </section>

        <!-- Policy Resolution -->
        <section id="policy-resolution">
            <h2>Policy Resolution Pattern</h2>
            
            <h3>How POP Uses Policy Resolution</h3>
            <p>While POPs primarily manage native vendor policies, they utilize PlainID's Policy Resolution API for complex data access scenarios.</p>

            <div class="endpoint">
                <span class="method post">POST</span>
                <span class="code-inline">/api/v1/policy/resolution</span>
            </div>

            <h3>Resolution Request (Snowflake Context)</h3>
            <div class="code">
<pre>{
  "identity": {
    "type": "user",
    "id": "snowflake_user@company.com",
    "attributes": {
      "department": "Finance",
      "clearance_level": 2,
      "region": "US_EAST"
    }
  },
  "scope": {
    "name": "snowflake-production"
  },
  "assetType": {
    "type": "table",
    "database": "ANALYTICS",
    "schema": "SALES",
    "table": "REVENUE_DATA"
  },
  "action": "SELECT",
  "context": {
    "warehouse": "COMPUTE_WH",
    "role": "ANALYST",
    "session_id": "sf_session_12345"
  }
}</pre>
            </div>

            <h3>Resolution Response</h3>
            <div class="code">
<pre>{
  "decision": "PERMIT",
  "nativePolicies": {
    "rowAccessPolicy": {
      "name": "finance_region_policy",
      "sql": "region IN ('US_EAST', 'US_CENTRAL')"
    },
    "maskingPolicies": [
      {
        "column": "ssn",
        "policy": "pii_mask_policy",
        "function": "REGEXP_REPLACE(val, '[0-9]', 'X')"
      },
      {
        "column": "salary",
        "policy": "salary_mask_policy", 
        "function": "CASE WHEN current_role() = 'HR' THEN val ELSE 0 END"
      }
    ]
  },
  "deploymentInstructions": {
    "applyRowPolicy": "ALTER TABLE analytics.sales.revenue_data SET ROW ACCESS POLICY finance_region_policy ON (region)",
    "applyMaskingPolicies": [
      "ALTER TABLE analytics.sales.revenue_data MODIFY COLUMN ssn SET MASKING POLICY pii_mask_policy",
      "ALTER TABLE analytics.sales.revenue_data MODIFY COLUMN salary SET MASKING POLICY salary_mask_policy"
    ]
  }
}</pre>
            </div>
        </section>

        <!-- Orchestration Workspace -->
        <section id="orchestration-workspace">
            <h2>Orchestration Workspace</h2>
            
            <h3>Workspace Overview</h3>
            <p>The Orchestration Workspace provides centralized visibility and management for all Snowflake policies.</p>

            <div class="tabs">
                <button class="tab active" onclick="showTab('vendor-policies')">Vendor Policies</button>
                <button class="tab" onclick="showTab('objects')">Objects</button>
                <button class="tab" onclick="showTab('policy-map')">Policy Map</button>
                <button class="tab" onclick="showTab('reconciliation')">Reconciliation</button>
            </div>

            <div id="vendor-policies" class="tab-content active">
                <h4>Vendor Policies Tab</h4>
                <p>Lists all discovered and managed Snowflake policies:</p>
                <ul>
                    <li>Native Snowflake row access policies</li>
                    <li>Masking policies with their conditions</li>
                    <li>Policy creation/modification timestamps</li>
                    <li>Deployment status (synced/pending/conflict)</li>
                </ul>
            </div>

            <div id="objects" class="tab-content">
                <h4>Objects Tab</h4>
                <p>Displays discovered Snowflake objects:</p>
                <ul>
                    <li>Databases and schemas hierarchy</li>
                    <li>Tables and views with column details</li>
                    <li>Warehouses and their configurations</li>
                    <li>Object relationships and dependencies</li>
                </ul>
            </div>

            <div id="policy-map" class="tab-content">
                <h4>Policy Map Visualization</h4>
                <p>Graphical representation showing:</p>
                <ul>
                    <li>Identity-to-resource access paths</li>
                    <li>Policy application flow</li>
                    <li>Effective permissions visualization</li>
                    <li>Access pattern analysis</li>
                </ul>
            </div>

            <div id="reconciliation" class="tab-content">
                <h4>Policy Reconciliation</h4>
                <p>Side-by-side comparison of:</p>
                <ul>
                    <li>PlainID policies vs Snowflake native policies</li>
                    <li>Pending changes awaiting deployment</li>
                    <li>Conflict detection and resolution</li>
                    <li>Drift analysis between environments</li>
                </ul>
            </div>
        </section>

        <!-- Monitoring -->
        <section id="monitoring">
            <h2>Monitoring & Auditing</h2>
            
            <h3>POP Activity Monitoring</h3>
            <p>Example of activity log entry for policy deployment:</p>
            <div class="code">
<pre># Activity Log Entry Example
{
  "timestamp": "2024-12-15T10:30:00Z",
  "popId": "snowflake-prod-pop",
  "action": "POLICY_DEPLOYED",
  "details": {
    "policyName": "revenue_access_policy",
    "targetObject": "ANALYTICS.SALES.REVENUE",
    "deploymentStatus": "SUCCESS",
    "changedBy": "admin@company.com",
    "approvedBy": "security_team",
    "snowflakeResponse": {
      "status": "APPLIED",
      "affectedRows": 1500000
    }
  }
}</pre>
            </div>

            <h3>Audit Capabilities</h3>
            <ul>
                <li><strong>Policy Changes:</strong> Complete history of all policy modifications</li>
                <li><strong>Discovery Events:</strong> Log of all discovery runs and findings</li>
                <li><strong>Deployment History:</strong> Record of all policy deployments to Snowflake</li>
                <li><strong>Access Patterns:</strong> Analysis of who accessed what data when</li>
                <li><strong>Compliance Reports:</strong> Automated compliance reporting for auditors</li>
            </ul>
        </section>

        <!-- Troubleshooting -->
        <section id="troubleshooting">
            <h2>Troubleshooting</h2>
            
            <h3>IP Allowlisting for PlainID Services</h3>
            <p>In case customer is restricting access via network policies they should allowlist the following IPs:</p>
            
            <table>
                <tr>
                    <th>Region</th>
                    <th>IP Addresses</th>
                </tr>
                <tr>
                    <td><strong>US region</strong></td>
                    <td>3.139.229.73<br>3.21.70.3<br>3.141.133.162</td>
                </tr>
                <tr>
                    <td><strong>EU region</strong></td>
                    <td>18.203.129.39<br>52.208.224.64<br>54.220.132.102</td>
                </tr>
                <tr>
                    <td><strong>CA region</strong></td>
                    <td>99.79.30.66<br>35.182.160.92<br>15.156.98.158</td>
                </tr>
            </table>
            
            <h3>Common Issues and Resolutions</h3>
            
            <table>
                <tr>
                    <th>Issue</th>
                    <th>Symptoms</th>
                    <th>Resolution</th>
                </tr>
                <tr>
                    <td>Discovery Incomplete</td>
                    <td>Some Snowflake objects not appearing in PlainID</td>
                    <td>Check service account permissions; ensure USAGE grants on all schemas</td>
                </tr>
                <tr>
                    <td>Policy Deployment Fails</td>
                    <td>Policies created in PlainID not applying to Snowflake</td>
                    <td>Verify APPLY POLICY privileges; check for conflicting native policies</td>
                </tr>
                <tr>
                    <td>Sync Conflicts</td>
                    <td>Discrepancies between PlainID and Snowflake policies</td>
                    <td>Use Reconciliation view; set conflict resolution strategy</td>
                </tr>
                <tr>
                    <td>Performance Issues</td>
                    <td>Slow discovery or deployment</td>
                    <td>Optimize discovery scope; use incremental discovery mode</td>
                </tr>
                <tr>
                    <td>Connection Timeouts</td>
                    <td>Test connection fails</td>
                    <td>Check network policies; verify warehouse is running</td>
                </tr>
                <tr>
                    <td>Policy Syntax Errors</td>
                    <td>"Cannot ADD policy" error when setting policies</td>
                    <td>Use SET instead of ADD: ALTER TABLE ... SET ROW ACCESS POLICY ...</td>
                </tr>
            </table>

            <h3>Debug Mode</h3>
            <div class="code">
<pre># Enable debug logging for POP
{
  "popId": "snowflake-prod-pop",
  "settings": {
    "logging": {
      "level": "DEBUG",
      "includeSnowflakeQueries": true,
      "logPolicyTranslations": true,
      "capturePerformanceMetrics": true
    }
  }
}</pre>
            </div>
        </section>

        <div class="alert success" style="margin-top: 3rem;">
            <strong>Best Practice:</strong> Start with Learn Mode to understand your existing Snowflake policies before enabling Manage Mode. This ensures a smooth transition to centralized policy management without disrupting existing access patterns.
        </div>

        <div class="alert warning" style="margin-top: 1rem;">
            <strong>Enterprise Edition Requirement:</strong> Snowflake Row Access Policies and Dynamic Data Masking require Enterprise Edition or higher. Ensure your Snowflake account meets this requirement before implementing PlainID POP integration.
        </div>

        <div class="alert info" style="margin-top: 2rem;">
            <strong>Documentation Based On:</strong> PlainID Platform Documentation & Snowflake Integration Announcement (December 2024)<br>
            <strong>Pattern:</strong> Policy Orchestration Point (POP) for SaaS Authorization Management<br>
            <strong>Snowflake Features:</strong> Row Access Policies, Dynamic Data Masking, Tag-Based Security (Enterprise Edition+)<br>
            <strong>Support:</strong> For production deployments, contact PlainID Technical Support for detailed implementation guidance.
        </div>
    </main>

    <script>
        // Tab functionality
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(tabName).classList.add('active');
            
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // Mode toggle
        function showMode(mode) {
            document.querySelectorAll('.mode-content').forEach(content => {
                content.style.display = 'none';
            });
            document.getElementById(mode + '-mode').style.display = 'block';
            
            document.querySelectorAll('.mode-toggle button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // Highlight flow steps
        function highlightStep(step) {
            document.querySelectorAll('.flow-node').forEach((node, index) => {
                node.classList.remove('active');
                if (index < step) {
                    node.style.opacity = '0.5';
                } else if (index === step - 1) {
                    node.classList.add('active');
                    node.style.opacity = '1';
                } else {
                    node.style.opacity = '1';
                }
            });
            
            // Animate the flow lines
            document.querySelectorAll('.flow-line').forEach((line, index) => {
                if (index < step - 1) {
                    line.classList.add('active');
                } else {
                    line.classList.remove('active');
                }
            });
        }

        // Auto-animate flow on page load
        let currentStep = 1;
        const maxSteps = 4;
        
        function animateFlow() {
            highlightStep(currentStep);
            currentStep++;
            if (currentStep > maxSteps) {
                currentStep = 1;
            }
        }
        
        // Start animation
        setInterval(animateFlow, 2000);

        // Navigation highlighting
        document.querySelectorAll('.sidebar a').forEach(link => {
            link.addEventListener('click', function(e) {
                document.querySelectorAll('.sidebar a').forEach(a => a.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Smooth scroll
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });
    </script>
</body>
</html>
